from utils.ExtrsUtil import ExtrsUtil
import pandas as pd
from data.DataBase import DataBase

"""
查询数据库所有stock_basic的股票代码，从stock_record得到价格数据，计算extra_val值后把数据都写入数据库stock_extra
"""

# 调用函数计算 EXTRS，假设 N = 50 , 150, 250
N = 50

config_file = '../../config.yml'
dataIns = DataBase(config_file)

# query_conditions = {"num": N}
# dates = dataIns.getDistinctCommonData('stock_extra', ['c_date'], query_conditions, 'c_date asc', '')
# # 使用列表推导式提取 code 的值
# dateArr = [item['c_date'] for item in dates]

dateArr = {

    '1981-10-28',
'2020-06-19',
'1976-11-16',
'1989-01-26',
'2006-04-25',
'1997-12-01',
'1971-04-27',
'2020-04-13',
'2024-07-26',
'1965-09-01',
'1975-03-26',
'1966-09-01',
'1995-10-02',
'1985-01-09',
'2021-02-05',
'2017-11-01',
'2006-02-06',
'1972-09-08',
'1965-03-11',
'2000-04-10',
'2008-12-02',
'2021-04-07',
'2020-09-03',
'1984-06-06',
'1985-10-04',
'1981-03-20',
'1981-03-24',
'1962-09-28',
'1967-01-26',
'2009-04-01',
'1981-02-25',
'2021-09-01',
'1978-06-19',
'1991-04-16',
'1983-07-01',
'1994-10-19',
'1977-10-27',
'2006-05-19',
'1968-09-27',
'1980-10-07',
'2008-12-15',
'2008-04-02',
'1994-10-28',
'2023-12-08',
'1992-02-14',
'1973-04-11',
'2007-11-27',
'1985-01-31',
'2023-03-17',
'1987-10-13',
'2021-08-19',
'1980-06-17',
'2002-09-17',
'1982-03-17',
'1969-09-17',
'1987-07-29',
'1972-08-15',
'2015-02-13',
'1964-06-16',
'1972-12-27',
'1983-01-31',
'2013-05-10',
'2011-09-19',
'1997-07-08',
'1989-10-26',
'2022-04-20',
'1997-06-30',
'1972-11-09',
'1969-06-10',
'1985-10-02',
'2004-04-21',
'1994-03-09',
'1967-06-14',
'1963-01-29',
'1974-02-28',
'2008-03-28',
'1978-04-28',
'1973-09-17',
'1973-08-01',
'2022-07-25',
'1970-03-09',
'2024-11-29',
'1995-02-02',
'1978-03-21',
'1985-06-19',
'1972-09-21',
'1984-12-21',
'2001-09-05',
'2000-04-17',
'1964-11-24',
'1986-09-24',
'2015-07-24',
'1981-06-23',
'1972-06-15',
'1979-08-22',
'2012-04-10',
'2023-02-22',
'2001-10-22',
'1976-03-09',
'1970-02-05',
'1998-03-17',
'2017-07-31',
'1995-09-19',
'1973-10-26',
'2010-12-30',
'2000-05-16',
'2019-08-08',
'2000-03-17',
'2008-10-07',
'1973-03-15',
'1996-11-12',
'1977-08-08',
'1998-12-31',
'1996-04-02',
'2001-05-29',
'1995-09-01',
'1981-10-12',
'2023-07-17',
'1963-12-09',
'2010-03-19',
'2020-10-23',
'2012-08-23',
'1965-09-24',
'1973-07-27',
'1982-02-04',
'1988-05-17',
'2012-08-14',
'2023-04-03',
'1969-12-23',
'2006-06-19',
'1972-01-21',
'1982-07-14',
'2005-01-20',
'2007-06-19',
'2015-07-03',
'1993-09-23',
'1996-10-31',
'2004-01-22',
'1981-08-11',
'1979-07-17',
'1983-02-23',
'2003-07-21',
'1964-08-06',
'2015-12-04',
'1981-03-16',
'1990-07-20',
'1995-07-07',
'1985-03-25',
'1988-02-19',
'2017-03-14',
'1976-02-17',
'1972-04-19',
'1978-05-23',
'1993-01-15',
'2010-12-10',
'1993-04-14',
'2004-06-04',
'1964-08-10',
'2003-02-27',
'2006-07-26',
'2001-10-12',
'2008-10-22',
'1964-07-21',
'2010-10-19',
'1968-11-15',
'1980-09-09',
'2020-07-30',
'2007-05-25',
'1971-10-15',
'1964-02-27',
'2020-11-18',
'2017-07-10',
'2010-08-25',
'1997-12-09',
'2013-04-04',
'1975-10-10',
'1978-01-31',
'2022-09-05',
'1999-07-30',
'2022-01-20',
'1983-10-13',
'1996-05-01',
'1998-07-29',
'1993-10-07',
'2000-02-08',
'2020-06-09',
'2023-07-04',
'1993-08-05',
'1988-12-05',
'1978-05-09',
'1963-11-11',
'1995-08-23',
'1965-08-12',
'1985-06-05',
'2007-07-05',
'2021-09-27',
'2005-04-06',
'1982-08-10',
'1995-09-29',
'1972-08-23',
'1969-10-10',
'1962-11-28',
'1965-09-08',
'2024-01-05',
'2005-04-13',
'1989-06-02',
'2006-05-10',
'2022-02-04',
'1989-02-01',
'1990-06-04',
'2014-05-02',
'1969-12-19',
'1974-07-09',
'2014-07-03',
'1968-07-01',
'1977-01-14',
'2014-06-20',
'1974-06-27',
'2004-12-09',
'1969-12-03',
'1974-09-23',
'2020-03-05',
'1994-04-21',
'2003-07-10',
'1965-11-17',
'1980-04-23',
'2002-06-14',
'2010-03-26',
'2012-07-25',
'1994-11-08',
'1999-03-19',
'1966-05-03',
'1968-05-24',
'1971-04-12',
'2022-08-05',
'1989-03-30',
'1966-12-21',
'2006-11-27',
'2011-12-22',
'1982-12-10',
'2017-10-03',
'1969-09-08',
'1986-09-10',
'2009-11-18',
'2010-03-11',
'1976-03-03',
'1963-12-27',
'2002-10-30',
'2012-01-27',
'2010-06-25',
'2023-01-26',
'1980-02-07',
'1974-01-16',
'2002-05-07',
'1991-02-01',
'2002-07-26',
'1986-01-06',
'2022-08-18',
'1986-04-25',
'1981-10-14',
'1987-12-01',
'1963-05-22',
'1965-12-13',
'1999-06-11',
'2009-07-15',
'2009-01-02',
'1969-05-02',
'1981-02-27',
'2013-06-06',
'2023-09-27',
'1984-12-28',
'1996-08-23',
'1982-12-15',
'2019-12-31',
'1987-06-29',
'1994-02-15',
'2012-02-20',
'2002-05-06',
'2007-06-01',
'1969-10-31',
'2007-04-24',
'2000-06-08',
'1985-04-15',
'2003-09-19',
'1980-06-20',
'1970-08-31',
'1990-01-05',
'2020-04-02',
'1965-07-15',
'2016-04-07',
'1982-10-12',
'2013-03-04',
'1976-05-25',
'1969-11-21',
'1976-04-20',
'2016-08-11',
'1996-10-24',
'2000-03-24',
'1995-09-05',
'1991-08-22',
'1977-09-14',
'1963-01-24',
'2020-09-07',
'1963-10-02',
'2019-06-24',
'2003-05-13',
'2003-03-04',
'2015-01-07',
'1980-04-11',
'2017-06-02',
'1990-01-04',
'1965-08-18',
'2023-01-30',
'1990-02-12',
'2019-03-29',
'1967-05-02',
'2005-02-03',
'1962-08-07',
'1971-06-04',
'1972-05-03',
'2011-09-23',
'2012-08-29',
'1963-01-04',
'2024-02-22',
'2013-01-23',
'2005-06-22',
'1971-10-07',
'2017-05-29',
'1974-06-18',
'2006-06-30',
'1994-04-26',
'1990-08-17',
'1977-06-17',
'1998-02-19',
'2016-12-02',
'2014-11-21',
'1981-03-11',
'2005-03-24',
'2009-06-26',
'1977-05-27',
'2016-06-17',
'2023-05-29',
'2018-08-31',
'2004-02-03',
'2023-09-19',
'2008-02-21',
'1967-03-06',
'1970-11-02',
'1993-09-15',
'1982-10-28',
'2014-05-23',
'1977-08-31',
'1968-05-17',
'1988-03-09',
'1983-02-03',
'2005-03-16',
'1972-09-14',
'1967-08-30',
'2006-11-02',
'1979-12-11',
'1988-11-17',
'2015-10-20',
'2008-04-09',
'2001-09-25',
'1972-02-28',
'1997-07-03',
'1976-01-16',
'1979-10-17',
'2007-01-11',
'2015-09-14',
'1974-11-27',
'2018-11-27',
'1983-10-31',
'1998-11-30',
'1970-07-01',
'2011-01-11',
'1963-07-17',
'1984-07-13',
'1994-10-13',
'1976-04-21',
'1978-04-27',
'1983-09-08',
'1969-07-11',
'2020-12-04',
'2021-02-15',
'2003-08-15',
'2000-12-28',
'1975-12-16',
'1968-04-30',
'2014-02-17',
'2016-01-28',
'1978-07-05',
'1984-04-25',
'1985-03-12',
'1976-02-05',
'2020-03-23',
'1964-06-23',
'2019-01-21',
'1971-03-09',
'2018-07-20',
'2017-08-09',
'1985-05-02',
'2020-05-20',
'1998-02-12',
'1965-05-24',
'1970-01-14',
'2015-04-10',
'1986-07-24',
'1973-03-20',
'1977-02-22',
'1964-03-23',
'2005-10-17',
'2017-11-20',
'2004-12-01',
'2022-04-04',
'2012-05-16',
'1996-03-29',
'1986-05-09',
'1994-07-06',
'1994-03-31',
'1967-07-05',
'1999-06-30',
'2018-06-04',
'2023-07-28',
'1965-06-30',
'1973-02-07',
'1968-03-25',
'2005-09-16',
'1984-02-28',
'1966-04-06',
'1976-08-10',
'2008-10-21',
'2019-03-20',
'1986-10-09',
'2005-02-15',
'1965-04-20',
'1981-06-11',
'2017-11-03',
'2002-10-01',
'2005-03-08',
'1989-11-29',
'2015-07-08',
'1969-05-14',
'1967-09-06',
'1993-06-16',
'1991-07-19',
'1987-10-30',
'1988-06-23',
'1991-02-27',
'2020-01-06',
'1987-08-10',
'1973-08-09',
'1969-08-06',
'1967-07-20',
'2007-07-20',
'2005-09-12',
'2020-01-02',
'2009-03-09',
'1978-02-07',
'1974-01-14',
'1976-08-02',
'1977-03-17',
'1996-11-29',
'1978-11-07',
'1971-01-19',
'1999-12-08',
'1971-08-11',
'2016-04-08',
'2020-01-28',
'1985-05-13',
'1967-05-01',
'1964-10-26',
'1978-05-15',
'2012-10-26',
'1983-07-25',
'1991-09-19',
'2023-05-25',
'1965-12-01',
'2024-02-23',
'2007-08-27',
'2019-01-04',
'1965-04-01',
'2006-06-07',
'2017-01-16',
'2006-05-26',
'2008-03-19',
'1980-12-31',
'2006-03-09',
'1986-04-07',
'1982-01-20',
'1976-02-13',
'1971-03-08',
'2005-10-04',
'2018-08-22',
'1991-07-05',
'2017-07-20',
'1962-07-18',
'2013-01-29',
'2014-03-03',
'2020-02-26',
'2001-02-26',
'2006-02-10',
'1996-07-15',
'1971-03-25',
'1964-12-09',
'1993-01-22',
'1997-05-01',
'1987-11-11',
'2000-01-27',
'1984-09-18',
'1970-06-24',
'1985-09-11',
'2000-07-12',
'1988-10-27',
'1990-12-18',
'1965-06-08',
'1990-06-01',
'1995-10-10',
'1985-11-05',
'1993-07-14',
'1970-12-14',
'1985-10-17',
'2000-01-25',
'1994-06-21',
'1978-08-10',
'1987-02-12',
'1975-04-17',
'2018-10-03',
'1986-03-04',
'1998-06-30',
'1979-11-23',
'2018-01-11',
'1978-11-16',
'1979-04-06',
'1964-05-19',
'1985-01-15',
'2003-04-15',
'2022-08-16',
'1996-05-16',
'2006-09-14',
'1995-08-28',
'1980-10-16',
'2013-02-13',
'1982-09-07',
'2020-01-15',
'1966-07-01',
'2010-10-26',
'1997-01-14',
'2010-05-31',
'1963-11-15',
'2001-11-23',
'2024-03-22',
'2006-11-21',
'1964-08-07',
'1999-08-04',
'1976-05-04',
'1999-02-24',
'1980-01-15',
'2023-03-02',
'2009-05-11',
'1965-07-27',
'1965-05-20',
'1964-10-19',
'2008-01-28',
'2004-10-21',
'2006-05-16',
'2023-05-31',
'2024-08-21',
'2004-12-10',
'1991-02-13',
'1997-09-25',
'1979-05-23',
'1979-03-09',
'2009-09-30',
'1988-06-21',
'1967-11-29',
'2007-06-21',
'2003-01-13',
'1966-05-23',
'1986-02-19',
'1999-07-01',
'1989-07-11',
'2017-03-29',
'2001-01-03',
'2007-04-30',
'1992-08-13',
'2019-04-08',
'2019-05-03',
'2004-01-12',
'2019-05-30',
'1983-06-03',
'1987-02-25',
'2008-05-05',
'2004-06-16',
'2006-03-29',
'2005-01-07',
'1987-06-05',
'1987-12-31',
'1963-12-23',
'1994-01-14',
'2019-01-10',
'1970-05-19',
'2005-03-09',
'1990-05-07',
'2016-11-30',
'1985-08-15',
'1966-01-31',
'1998-05-22',
'1995-12-04',
'1974-05-16',
'2012-04-24',
'2019-07-03',
'1966-11-11',
'1995-10-18',
'2001-01-05',
'1988-05-04',
'1967-06-09',
'2005-02-22',
'1997-04-07',
'2004-09-21',
'2013-07-11',
'2013-05-20',
'1986-07-29',
'2011-12-16',
'1975-12-26',
'1989-12-22',
'2001-12-13',
'1974-10-25',
'1970-05-15',
'1986-09-25',
'1983-03-10',
'1963-12-26',
'2015-02-25',
'2013-11-29',
'1993-09-20',
'2017-12-12',
'1977-12-23',
'1984-03-14',
'2016-04-04',
'1988-06-14',
'1973-10-30',
'1987-03-19',
'1976-01-08',
'2000-10-18',
'1994-04-08',
'2020-09-02',
'1994-08-31',
'2013-04-24',
'1997-06-16',
'2018-11-02',
'1977-11-28',
'1967-06-13',
'2008-01-03',
'1975-10-01',
'1978-06-06',
'1989-10-17',
'1996-10-21',
'2003-02-10',
'2009-12-11',
'1968-07-03',
'2016-01-14',
'1986-09-22',
'2003-06-06',
'1962-05-09',
'1979-12-03',
'1988-06-06',
'2011-06-28',
'2023-05-01',
'2021-09-28',
'1977-07-29',
'1973-01-23',
'1962-12-14',
'2023-03-06',
'1986-10-10',
'2002-02-07',
'1993-11-22',
'1971-08-23',
'2000-07-05',
'1996-09-23',
'1964-10-27',
'1981-10-22',
'2019-08-27',
'1972-01-04',
'1983-10-24',
'2012-10-05',
'1966-12-13',
'1977-10-14',
'1992-10-27',
'1971-07-23',
'1997-05-15',
'1994-12-14',
'2013-03-25',
'2011-01-27',
'2009-08-31',
'1965-01-06',
'1980-11-06',
'2007-11-21',
'2009-10-07',
'1977-06-06',
'1997-10-15',
'1984-06-12',
'1985-10-18',
'1981-05-14',
'1968-10-22',
'1966-10-05',
'1966-10-25',
'1990-03-20',
'1994-01-27',
'2003-10-24',
'2020-03-02',
'2017-03-17',
'1999-03-25',
'1991-05-06',
'1984-10-23',
'2006-07-31',
'2019-02-26',
'2022-03-25',
'2000-02-04',
'1962-06-11',
'1985-07-26',
'1981-06-30',
'1966-02-08',
'1972-09-11',
'1977-04-11',
'1964-08-24',
'1964-09-30',
'1988-01-29',
'2001-11-15',
'1967-08-11',
'1985-06-10',
'2017-09-29',
'2010-07-07',
'1965-06-01',
'2014-06-24',
'1972-10-27',
'2005-02-11',
'1970-12-09',
'1975-12-08',
'2015-04-07',
'1971-07-01',
'2017-05-26',
'2023-06-06',
'1980-04-01',
'1962-07-11',
'1965-08-03',
'2011-01-07',
'2020-07-03',
'1994-08-09',
'1962-08-16',
'1993-10-14',
'2016-10-19',
'1971-10-26',
'1982-12-20',
'1964-01-21',
'2015-11-25',
'2009-04-30',
'2024-11-19',
'2003-03-20',
'2009-01-14',
'1986-02-05',
'2014-12-23',
'1978-01-11',
'1968-02-09',
'2007-07-13',
'2012-02-23',
'1976-11-09',
'1977-10-26',
'2015-08-25',
'2007-11-05',
'1988-06-09',
'2000-11-16',
'1977-11-09',
'1983-01-19',
'1988-02-09',
'1998-04-06',
'1974-08-07',
'2019-12-02',
'1974-12-19',
'2012-10-19',
'2019-11-13',
'1998-05-21',
'2016-09-08',
'2014-01-23',
'1976-03-11',
'1987-07-13',
'2009-08-21',
'2023-06-26',
'1987-07-07',
'1984-11-19',
'2024-09-09',
'2008-12-11',
'1970-03-23',
'1985-08-08',
'1964-04-14',
'1995-08-14',
'1999-10-20',
'1987-04-23',
'2008-09-30',
'2016-11-29',
'2010-08-20',
'1963-03-05',
'2021-11-05',
'1987-01-02',
'2007-02-27',
'1966-01-12',
'1976-02-02',
'1990-06-13',
'1975-06-06',
'1992-09-11',
'1980-08-01',
'1987-05-13',
'1962-12-05',
'2009-11-13',
'2001-09-20',
'1988-03-08',
'2018-08-20',
'1964-09-29',
'1982-05-14',
'2021-03-18',
'1993-07-29',
'2017-01-04',
'1978-09-11',
'1966-02-01',
'2006-10-16',
'2024-10-11',
'2006-07-19',
'1974-07-01',
'2000-04-07',
'2003-06-09',
'2006-06-20',
'1969-08-21',
'1967-04-14',
'1986-11-10',
'1998-11-23',
'2023-05-03',
'1980-02-08',
'1987-05-28',
'2016-09-27',
'1999-01-27',
'1992-11-04',
'1995-09-26',
'2021-07-20',
'2024-11-25',
'1990-04-06',
'2014-05-08',
'1995-03-14',
'1967-04-25',
'1990-04-25',
'1991-12-26',
'2023-03-16',
'1972-09-05',
'2006-02-28',
'2020-07-24',
'1988-10-21',
'2024-08-26',
'1972-08-22',
'2007-05-22',
'2021-10-08',
'1976-03-15',
'1998-02-26',
'2015-06-29',
'1997-04-01',
'2000-02-07',
'2017-06-08',
'1991-10-09',
'2009-04-03',
'1987-03-24',
'2009-02-11',
'1965-02-26',
'1993-04-02',
'2013-11-04',
'1974-10-31',
'1965-06-03',
'1999-01-19',
'2006-08-29',
'2003-08-27',
'1988-08-29',
'1981-03-10',
'1999-07-19',
'2023-03-13',
'1976-07-21',
'2000-06-01',
'1976-08-24',
'2021-03-31',
'2005-01-24',
'1965-11-18',
'1978-09-20',
'1982-10-05',
'1972-02-17',
'1987-09-29',
'2023-03-21',
'1964-06-04',
'1995-06-26',
'1994-06-07',
'2004-06-25',
'1985-05-14',
'1997-10-07',
'1973-07-17',
'1970-10-07',
'1992-05-15',
'1979-02-08',
'1971-04-14',
'2015-09-15',
'1988-02-12',
'1990-07-18',
'2001-06-26',
'1988-07-13',
'2006-05-08',
'1966-06-21',
'2017-03-03',
'1970-06-22',
'1980-06-25',
'1997-08-11',
'1985-04-09',
'1982-03-11',
'2023-01-05',
'1975-02-20',
'1969-09-05',
'1994-04-18',
'1962-07-05',
'1971-05-20',
'1986-02-21',
'1973-02-20',
'2018-06-22',
'2007-11-16',
'2019-06-06',
'2023-12-18',
'2011-05-25',
'1998-07-16',
'2008-06-05',
'1995-05-25',
'1988-06-03',
'2020-05-25',
'2010-06-01',
'2003-12-03',
'1964-11-06',
'1980-03-20',
'2014-09-23',
'1991-01-11',
'1984-12-03',
'2008-12-29',
'1975-12-30',
'1962-08-24',
'2019-10-22',
'2010-10-18',
'2002-03-04',
'2022-04-18',
'2009-06-12',
'1977-04-25',
'1991-09-03',
'1998-06-22',
'2019-11-15',
'1989-08-22',
'1994-06-28',
'1962-10-02',
'1990-03-09',
'2017-01-26',
'1968-06-03',
'1982-08-12',
'2008-03-06',
'1971-12-31',
'2014-01-02',
'2019-07-01',
'1999-10-28',
'1987-12-30',
'2021-04-28',
'2020-11-20',
'2020-07-22',
'2014-10-13',
'2018-01-16',
'1967-09-21',
'2021-12-09',
'1976-03-05',
'1994-08-18',
'2024-07-08',
'1973-01-11',
'1973-10-15',
'1984-01-09',
'2006-09-29',
'1985-08-14',
'1985-11-15',
'1972-07-10',
'1992-11-20',
'1982-05-17',
'1990-06-27',
'1966-06-30',
'1969-05-19',
'1997-01-28',
'2018-06-21',
'1994-08-15',
'1977-02-03',
'2024-04-29',
'1969-02-06',
'1972-07-05',
'1997-03-27',
'2012-04-13',
'1998-01-06',
'1968-11-04',
'1976-05-18',
'2010-08-12',
'2014-09-09',
'2014-06-26',
'2007-09-04',
'2001-07-26',
'1986-03-31',
'1999-04-21',
'2021-07-28',
'2002-12-20',
'2011-02-18',
'2022-04-27',
'1992-08-24',
'1999-03-03',
'2003-06-04',
'1990-01-25',
'1984-01-04',
'1965-01-11',
'1983-06-13',
'1989-03-03',
'1993-04-16',
'1973-08-06',
'1975-09-11',
'2013-11-07',
'2022-03-15',
'2022-01-31',
'2002-03-20',
'2015-09-04',
'2013-10-18',
'2022-09-28',
'2019-01-29',
'1977-07-12',
'1979-08-31',
'1988-05-12',
'2015-10-15',
'1986-07-15',
'2008-12-05',
'1996-04-11',
'2004-02-13',
'2023-04-04',
'1982-06-02',
'1972-10-31',
'2023-05-19',
'1972-08-29',
'1966-04-25',
'2020-01-17',
'2012-09-17',
'1965-03-12',
'1988-03-28',
'2021-05-20',
'1984-01-05',
'1979-02-09',
'1976-05-19',
'2015-10-29',
'1975-03-12',
'2005-03-31',
'1992-12-14',
'1981-02-23',
'1967-07-17',
'1979-04-18',
'2017-06-22',
'1984-03-16',
'2010-09-03',
'2017-02-02',
'2017-10-06',
'2004-04-22',
'2019-04-02',
'1994-12-23',
'1978-12-18',
'2002-02-06',
'1977-11-03',
'1991-07-12',
'1972-08-17',
'1974-07-08',
'1975-08-28',
'2015-09-30',
'1980-08-15',
'1965-01-08',
'1970-12-23',
'2000-07-24',
'1976-07-29',
'1970-05-25',
'2024-05-01',
'2019-03-01',
'1974-05-20',
'1964-03-25',
'1982-05-11',
'1999-11-15',
'2003-04-17',
'2021-07-30',
'1974-04-22',
'1978-04-17',
'1967-10-17',
'1984-09-25',
'2022-07-22',
'1972-05-16',
'1992-09-10',
'2013-10-01',
'1970-11-13',
'2014-01-03',
'1999-01-25',
'2017-05-15',
'1983-02-10',
'2014-05-21',
'1998-12-02',
'2007-01-30',
'2017-06-15',
'2004-01-29',
'1975-08-21',
'1968-06-04',
'2022-07-04',
'2017-04-12',
'2015-08-13',
'1970-01-21',
'1972-02-11',
'1984-01-12',
'1987-08-20',
'1978-02-06',
'1978-10-20',
'1983-09-07',
'1981-03-04',
'1975-03-06',
'1967-08-15',
'1994-12-05',
'2012-06-20',
'1982-09-27',
'1999-10-25',
'1970-07-20',
'1982-08-23',
'1993-09-17',
'2014-08-05',
'1988-09-27',
'1982-01-27',
'1979-10-03',
'2018-11-01',
'2002-02-12',
'1986-10-28',
'1974-11-22',
'2021-01-08',
'1995-03-01',
'2010-06-24',
'2012-06-26',
'1998-03-04',
'2020-01-31',
'1987-07-14',
'1964-01-14',
'2012-09-05',
'1992-12-29',
'1972-07-26',
'1978-10-11',
'2002-12-11',
'2003-09-10',
'1994-05-26',
'2013-10-29',
'1990-05-29',
'2005-11-09',
'1970-06-18',
'2000-04-26',
'1975-02-26',
'1970-12-30',
'1974-07-24',
'2006-06-08',
'1989-07-27',
'1993-07-15',
'1996-02-29',
'2003-06-30',
'2006-07-28',
'1964-05-21',
'1971-10-18',
'2001-01-17',
'2000-02-01',
'1970-03-10',
'2005-06-09',
'1989-07-03',
'1963-10-08',
'2021-06-04',
'2001-12-20',
'1999-09-21',
'1998-04-14',
'1995-08-01',
'2010-06-30',
'1967-08-22',
'1964-06-26',
'1993-07-27',
'1981-01-23',
'2022-07-14',
'2002-07-09',
'1990-02-02',
'2000-04-28',
'2001-09-06',
'1977-03-18',
'1973-11-09',
'1968-05-01',
'2018-03-28',
'1991-08-06',
'2022-04-07',
'1999-11-03',
'1969-10-06',
'1993-05-12',
'2023-01-24',
'2018-03-21',
'1994-01-26',
'2023-03-24',
'1996-05-10',
'1996-08-21',
'2000-03-16',
'2017-11-22',
'2008-01-23',
'1967-01-25',
'1992-12-23',
'1973-06-01',
'2021-11-09',
'2018-01-18',
'2012-05-03',
'2019-01-22',
'2021-04-20',
'1993-01-08',
'2012-06-14',
'2002-11-25',
'1996-10-25',
'1994-03-30',
'2024-10-23',
'2000-11-10',
'1986-02-26',
'2005-12-21',
'1986-02-12',
'1967-06-30',
'1985-07-29',
'1994-03-22',
'1966-07-27',
'1965-07-07',
'2012-03-09',
'1970-07-15',
'2022-05-06',
'1983-03-11',
'2024-04-02',
'1988-04-20',
'1989-10-20',
'2005-05-12',
'1996-01-24',
'1965-06-16',
'1965-06-29',
'2023-03-15',
'1978-05-22',
'2001-03-28',
'1967-03-17',
'1979-10-02',
'1976-04-01',
'2014-11-24',
'2021-02-11',
'1980-09-29',
'2010-04-22',
'2008-09-02',
'2003-11-19',
'1987-10-20',
'2017-11-24',
'2007-06-28',
'2002-09-23',
'2011-10-06',
'1975-10-20',
'1967-11-30',
'1979-01-05',
'1998-03-24',
'1997-12-24',
'1963-10-22',
'1976-06-29',
'2017-10-13',
'1963-05-28',
'1981-08-27',
'1980-06-09',
'2023-10-02',
'2018-01-15',
'1971-03-26',
'2020-06-12',
'1968-09-12',
'1993-12-22',
'1995-05-10',
'2010-09-02',
'1987-12-03',
'2008-06-16',
'2011-02-04',
'1969-03-14',
'1988-10-28',
'1976-01-14',
'1998-03-18',
'2016-11-07',
'1999-05-18',
'2018-02-06',
'1979-05-30',
'1987-02-06',
'1996-01-25',
'1999-09-15',
'2009-04-14',
'1977-10-31',
'2017-07-24',
'1971-01-06',
'1987-12-14',
'2001-04-06',
'2005-04-01',
'1976-04-05',
'1969-07-16',
'1970-05-01',
'2010-10-06',
'1987-01-27',
'2001-03-01',
'1973-05-24',
'2008-05-20',
'1983-03-14',
'1972-02-02',
'1993-12-13',
'1967-07-18',
'1995-03-21',
'2013-01-02',
'2021-11-03',
'1967-10-02',
'2007-12-11',
'2005-08-04',
'2009-07-21',
'1981-05-11',
'1971-11-22',
'1974-04-26',
'2004-05-14',
'1969-08-01',
'2001-05-16',
'1975-05-06',
'2002-04-24',
'1988-11-08',
'2023-03-22',
'2000-09-25',
'1984-08-03',
'1991-10-18',
'1982-01-29',
'1973-10-25',
'1962-10-22',
'1974-08-02',
'2014-09-18',
'1973-01-03',
'2006-03-21',
'1985-10-16',
'1995-10-06',
'1981-07-30',
'2014-05-09',
'1997-07-01',
'2014-05-22',
'1977-12-27',
'1988-01-04',
'1983-04-04',
'1983-08-05',
'1988-05-25',
'1980-02-01',
'2003-09-26',
'2023-11-30',
'2014-12-30',
'2004-11-10',
'2011-12-15',
'1968-02-21',
'2007-09-17',
'1968-01-03',
'1975-06-17',
'1969-11-11',
'1971-08-20',
'2013-03-05',
'1993-08-03',
'2001-12-19',
'1974-11-29',
'2022-03-31',
'1981-10-09',
'2000-06-07',
'1980-07-02',
'2020-01-13',
'2022-05-11',
'2009-01-28',
'2006-08-28',
'1977-07-19',
'2014-07-30',
'2000-08-14',
'2009-04-28',
'2008-09-12',
'2017-07-07',
'2007-08-24',
'2001-03-29',
'1994-01-06',
'2004-11-05',
'2009-10-29',
'1982-09-15',
'1975-09-29',
'1976-01-06',
'1964-10-28',
'1964-06-09',
'2005-08-08',
'2014-10-22',
'1964-03-24',
'2018-06-28',
'1990-04-20',
'1990-07-16',
'2005-09-06',
'1978-02-16',
'1971-03-17',
'1974-06-03',
'1995-06-23',
'1992-09-22',
'1990-06-11',
'1974-03-05',
'1976-05-03',
'1978-08-09',
'1987-01-07',
'1984-11-13',
'1989-09-05',
'1964-05-25',
'1988-05-05',
'2016-01-20',
'2018-10-24',
'2005-08-11',
'2005-04-19',
'2020-10-08',
'2011-07-21',
'2023-05-18',
'1968-10-01',
'2024-01-29',
'1999-04-16',
'2003-10-21',
'1969-04-08',
'1982-04-19',
'2010-11-23',
'1987-05-08',
'1977-03-14',
'2017-12-27',
'1998-02-04',
'2016-09-30',
'1996-01-26',
'1990-10-02',
'2011-03-28',
'2021-03-22',
'2000-06-16',
'2024-09-17',
'2002-11-11',
'1964-05-15',
'2015-11-05',
'2009-12-24',
'1971-05-18',
'1995-11-14',
'2014-11-04',
'1977-03-04',
'2001-10-25',
'1971-12-30',
'1962-10-15',
'2002-07-25',
'1987-06-19',
'2011-10-07',
'2023-01-20',
'2010-10-04',
'2020-12-21',
'1990-12-03',
'1969-12-08',
'1991-07-25',
'1998-07-21',
'2008-06-13',
'1987-06-10',
'1975-05-29',
'2003-04-04',
'2018-09-28',
'2024-08-28',
'1964-05-11',
'2005-02-23',
'2010-09-16',
'2013-11-19',
'2003-11-13',
'1992-04-06',
'1981-11-23',
'2023-01-11',
'2023-10-17',
'1995-01-18',
'2018-11-21',
'1967-05-04',
'1993-05-21',
'1995-02-23',
'2007-12-24',
'1982-02-23',
'2021-04-23',
'1994-10-24',
'1997-08-25',
'2010-09-06',
'2020-06-08',
'1983-02-28',
'1965-07-28',
'1962-07-26',
'1995-12-15',
'2016-06-20',
'1989-07-12',
'2021-12-07',
'2009-02-27',
'1974-09-10',
'1962-10-05',
'1993-03-11',
'2015-02-11',
'2019-09-03',
'1968-10-18',
'1964-12-24',
'1978-02-21',
'1991-12-10',
'1995-01-17',
'1984-10-26',
'1989-09-19',
'2011-05-04',
'1989-07-21',
'1985-02-04',
'1990-01-31',
'1995-09-28',
'2017-05-09',
'2008-07-17',
'2013-05-28',
'1989-12-06',
'2024-06-13',
'1995-09-08',
'2019-05-01',
'1990-12-19',
'1984-11-08',
'1985-07-03',
'2010-05-26',
'1966-07-11',
'1992-03-23',
'2013-05-16',
'2007-10-25',
'1989-02-02',
'1986-07-07',
'2015-12-07',
'2019-10-30',
'1993-11-01',
'1991-01-25',
'2006-02-15',
'1995-03-10',
'1965-08-27',
'2001-11-06',
'2004-11-11',
'1997-03-14',
'2013-03-06',
'1970-09-23',
'1980-09-16',
'1969-10-30',
'1973-01-26',
'1985-12-17',
'1997-06-12',
'1985-02-07',
'1978-05-16',
'1992-11-09',
'1962-09-21',
'1968-07-19',
'1978-12-13',
'1977-08-17',
'1994-10-31',
'2004-07-16',
'1987-11-24',
'1967-01-05',
'1971-10-01',
'2012-11-13',
'2018-08-30',
'1993-07-07',
'2018-12-20',
'1986-07-08',
'1965-07-26',
'2020-10-20',
'1977-03-11',
'2005-05-24',
'1979-07-11',
'2012-04-30',
'1984-04-16',
'2020-04-01',
'1962-04-05',
'2022-11-08',
'1998-01-05',
'1989-06-09',
'1991-10-22',
'1975-09-19',
'1986-06-04',
'2014-11-13',
'1963-08-09',
'2019-02-19',
'1985-07-09',
'1972-07-21',
'1976-12-13',
'2009-01-27',
'1981-08-19',
'1976-09-29',
'1974-04-03',
'1997-06-09',
'1999-09-14',
'2000-08-17',
'2015-12-30',
'2000-09-22',
'2005-10-03',
'1983-06-20',
'1967-04-24',
'1965-11-11',
'1997-09-05',
'2010-04-05',
'1999-09-30',
'2023-11-03',
'1996-04-18',
'1981-06-08',
'2001-12-14',
'2009-12-03',
'1987-03-03',
'1983-07-27',
'2004-11-12',
'1990-09-14',
'2010-05-21',
'1976-07-12',
'2017-04-28',
'1973-03-12',
'1978-07-19',
'1996-03-27',
'1978-04-12',
'2002-10-28',
'1993-09-28',
'2024-10-08',
'1995-04-11',
'2003-05-20',
'1998-03-30',
'2017-10-17',
'2023-11-24',
'1983-03-25',
'1968-04-29',
'1985-11-18',
'2020-11-16',
'2018-06-29',
'2013-07-22',
'2020-10-21',
'2019-12-16',
'2017-05-23',
'1967-09-01',
'2013-10-25',
'1992-03-05',
'1965-01-14',
'2018-04-25',
'2013-07-29',
'2016-07-11',
'1972-09-28',
'1982-01-04',
'1970-07-09',
'2004-01-13',
'1973-12-11',
'2013-07-17',
'1978-09-05',
'1996-12-20',
'1984-02-01',
'1995-04-28',
'1995-01-06',
'2005-07-25',
'2010-11-25',
'2019-04-29',
'2023-11-22',
'2022-03-04',
'2016-03-09',
'2022-05-17',
'1983-07-13',
'1966-11-09',
'1971-12-14',
'2023-06-16',
'1975-01-15',
'2014-06-09',
'2014-01-28',
'1989-08-02',
'1973-09-06',
'1963-07-10',
'2006-07-06',
'2005-12-19',
'2016-12-12',
'2001-09-26',
'2005-07-20',
'1966-03-25',
'2006-09-13',
'1976-06-15',
'2006-06-05',
'2001-07-05',
'1969-10-03',
'1973-07-02',
'1971-08-03',
'2001-07-17',
'2012-07-30',
'1984-12-24',
'1984-02-08',
'1987-05-27',
'1984-10-18',
'1985-12-10',
'2018-05-03',
'1965-03-01',
'2006-10-31',
'1967-07-27',
'2012-08-03',
'1970-04-30',
'1998-02-20',
'1975-11-26',
'1988-03-01',
'2012-01-13',
'2020-10-22',
'2002-08-29',
'1998-07-02',
'1962-11-14',
'1983-05-24',
'1963-01-22',
'2004-02-19',
'2024-06-04',
'2001-06-19',
'1995-12-06',
'2017-01-13',
'2021-05-26',
'2001-06-18',
'1984-02-10',
'2016-12-27',
'2012-04-16',
'1998-11-10',
'2014-09-26',
'2020-05-07',
'1966-08-17',
'2015-07-14',
'2019-04-09',
'2024-02-28',
'1969-09-12',
'2008-05-28',
'2012-06-11',
'1965-02-04',
'1981-09-01',
'1975-04-09',
'1973-12-06',
'1970-01-06',
'1967-03-28',
'1980-06-05',
'2016-06-21',
'1969-05-16',
'1970-07-10',
'1973-07-06',
'2018-08-01',
'1963-10-10',
'1982-08-18',
'2006-12-27',
'1994-06-22',
'1984-07-31',
'1995-10-04',
'1971-07-28',
'1970-03-17',
'1965-09-29',
'1988-01-28',
'1963-05-03',
'1978-02-17',
'1970-09-10',
'2003-12-04',
'2009-12-15',
'1983-11-16',
'2009-07-20',
'2019-07-23',
'1994-10-17',
'1971-11-17',
'2008-08-13',
'2003-07-29',
'1976-12-29',
'2019-10-14',
'2023-06-14',
'2003-01-03',
'2009-12-01',
'1975-12-31',
'1962-12-27',
'2019-11-06',
'1986-05-08',
'1968-04-01',
'1981-10-29',
'1992-07-23',
'2019-06-11',
'1979-08-08',
'2004-03-02',
'2003-04-28',
'1985-05-06',
'1995-01-19',
'1974-10-29',
'1994-11-28',
'2003-04-09',
'2005-01-04',
'1982-08-13',
'1991-02-26',
'1982-11-03',
'2017-11-15',
'2018-03-15',
'2009-07-28',
'2022-12-08',
'2010-07-13',
'2014-08-27',
'2001-05-10',
'2004-09-15',
'1993-06-14',
'1974-10-18',
'1993-10-26',
'2000-03-30',
'1999-01-11',
'2022-09-14',
'1972-09-18',
'1987-06-04',
'2019-08-23',
'2000-10-04',
'1963-01-10',
'2024-03-25',
'1964-09-21',
'1997-09-23',
'2018-12-13',
'1969-09-10',
'2018-03-19',
'1984-07-26',
'1984-09-06',
'1990-02-14',
'2013-07-16',
'1985-06-12',
'1973-03-02',
'1993-09-10',
'1976-11-26',
'1978-07-27',
'2011-05-10',
'2010-09-09',
'1977-04-20',
'1967-10-05',
'1969-10-02',
'1992-02-07',
'1974-01-17',
'1990-09-12',
'1978-05-31',
'1994-01-10',
'2016-05-30',
'2022-09-16',
'1971-09-21',
'1987-05-21',
'1989-09-15',
'2006-07-05',
'1987-07-16',
'2021-04-09',
'1984-12-17',
'1990-02-22',
'2003-12-12',
'2024-08-12',
'2004-10-28',
'2015-08-28',
'1967-01-24',
'1991-06-05',
'2018-08-14',
'2010-11-15',
'2005-10-12',
'1999-03-22',
'1986-04-14',
'1973-10-02',
'1976-04-22',
'2001-03-12',
'1984-04-24',
'2008-07-21',
'2024-06-06',
'1979-04-24',
'1994-03-18',
'1992-06-25',
'1998-09-23',
'2016-10-24',
'2006-06-29',
'1982-02-17',
'1973-09-10',
'2005-11-16',
'2015-08-05',
'2005-05-03',
'1972-07-07',
'1974-06-13',
'1984-05-24',
'2013-05-17',
'1978-01-30',
'2019-07-16',
'2018-07-12',
'1987-11-04',
'1992-03-10',
'1988-05-03',
'2002-04-17',
'1991-10-31',
'1992-06-17',
'2015-02-02',
'1966-08-10',
'2004-03-19',
'1996-05-24',
'2024-09-05',
'1978-08-28',
'2001-02-28',
'2014-08-21',
'1977-01-27',
'1992-07-14',
'1983-08-29',
'1989-08-09',
'1990-04-18',
'2005-09-14',
'2020-01-21',
'1981-08-21',
'1979-11-16',
'2002-08-01',
'1986-02-10',
'1968-10-08',
'1999-12-17',
'2012-05-28',
'1980-05-13',
'1962-06-08',
'2009-09-03',
'1962-12-18',
'1981-04-10',
'2016-06-24',
'2002-04-26',
'2024-02-29',
'2008-04-04',
'1969-06-13',
'1985-07-18',
'1989-05-24',
'1994-08-29',
'2003-09-17',
'1992-03-30',
'1968-10-28',
'1968-09-04',
'1996-06-20',
'2014-12-24',
'1965-02-03',
'1965-11-12',
'1962-08-29',
'2009-08-04',
'2002-06-28',
'2010-09-17',
'2002-01-14',
'2013-06-13',
'2006-10-05',
'1980-05-27',
'1986-03-18',
'1963-06-21',
'2024-08-07',
'1984-10-15',
'2015-02-20',
'2018-06-01',
'1994-12-06',
'1982-04-28',
'1985-01-07',
'1997-04-02',
'2024-06-26',
'1984-10-10',
'1987-03-04',
'2014-09-29',
'1995-02-15',
'1977-06-24',
'2015-04-17',
'2015-06-03',
'1988-01-12',
'1980-09-05',
'1969-02-07',
'2010-05-04',
'1962-11-19',
'1979-03-15',
'1990-02-01',
'2001-05-01',
'1963-08-23',
'2001-06-04',
'1972-05-18',
'1984-07-03',
'1971-04-13',
'1984-07-18',
'1984-09-04',
'1997-04-17',
'2020-08-31',
'2024-11-13',
'1990-05-14',
'1989-08-28',
'2003-10-22',
'1973-10-29',
'1974-02-13',
'1999-02-16',
'1981-04-09',
'1985-07-24',
'1969-04-07',
'2008-07-08',
'1975-02-19',
'1983-07-28',
'2001-06-15',
'1967-10-10',
'1976-07-14',
'2009-02-09',
'1998-04-13',
'1987-09-24',
'2004-08-17',
'2018-11-19',
'2007-02-07',
'2020-12-09',
'1967-10-18',
'1967-11-15',
'2016-05-04',
'2006-01-09',
'1962-09-12',
'2011-10-11',
'1983-03-30',
'1963-07-26',
'2010-02-10',
'1995-08-17',
'2019-03-14',
'1963-09-30',
'1965-02-08',
'2010-02-17',
'2023-11-21',
'1995-09-12',
'1982-07-29',
'2004-07-20',
'1995-05-02',
'2016-04-21',
'2008-12-24',
'1985-02-08',
'2010-03-17',
'2023-10-16',
'1973-02-21',
'2022-10-04',
'1974-12-30',
'1974-09-06',
'1974-07-17',
'1966-04-21',
'2006-12-22',
'1998-12-24',
'1985-10-07',
'2011-06-13',
'1988-03-17',
'2012-04-03',
'2012-11-21',
'2012-08-24',
'2008-10-15',
'1990-03-05',
'1997-04-28',
'1988-04-08',
'2020-11-11',
'1983-12-13',
'1974-02-01',
'2018-09-03',
'1991-08-30',
'1993-02-10',
'2009-12-23',
'2022-02-25',
'2004-12-15',
'2004-06-14',
'1963-08-13',
'2005-11-04',
'2022-07-01',
'1990-01-02',
'2007-05-11',
'1980-12-23',
'2014-11-07',
'2016-10-10',
'1971-10-29',
'1992-03-04',
'1977-02-11',
'2005-05-26',
'1982-11-11',
'1989-06-01',
'2017-07-13',
'1971-06-03',
'2019-02-07',
'1995-02-21',
'2020-09-04',
'1997-06-19',
'2000-05-09',
'1977-01-19',
'1977-09-28',
'2022-09-29',
'1986-09-04',
'2005-05-31',
'1967-10-12',
'1975-08-29',
'1985-12-19',
'1985-04-23',
'1991-04-12',
'1968-03-20',
'2010-06-17',
'1986-07-03',
'2002-05-23',
'1990-03-13',
'1963-06-26',
'1995-01-03',
'1978-01-10',
'2003-04-02',
'2017-04-05',
'1981-09-29',
'1991-03-25',
'2001-05-08',
'1967-04-06',
'2008-01-21',
'1982-08-09',
'1977-09-07',
'2000-06-02',
'1982-12-27',
'2018-07-23',
'2008-03-25',
'1998-08-03',
'2018-11-15',
'1971-03-23',
'2019-11-21',
'1993-10-19',
'1968-03-05',
'2008-11-06',
'1974-01-15',
'2017-07-05',
'1964-01-22',
'1989-08-23',
'1975-05-28',
'2017-01-30',
'1996-06-21',
'1989-06-16',
'2000-03-07',
'1973-02-14',
'1982-10-25',
'1994-10-06',
'1985-11-21',
'1992-05-14',
'2008-09-24',
'2022-01-21',
'1975-10-15',
'1976-10-14',
'1979-10-05',
'1997-02-27',
'1962-12-24',
'1994-01-28',
'1999-07-06',
'2014-08-11',
'2013-08-06',
'1973-05-07',
'1993-03-23',
'2019-12-30',
'1994-01-24',
'1980-01-22',
'1999-07-14',
'1967-08-17',
'1971-11-16',
'1967-03-15',
'1982-06-24',
'1969-05-22',
'2013-04-12',
'1984-06-19',
'1975-02-04',
'1995-08-11',
'1975-09-24',
'2013-05-14'
}
print(dateArr)

## 写入数据库字段
fields = ['code', 'c_date', 'extra_val', 'num', 'rank_val']

pd.set_option('display.max_rows', None)  # 显示所有行
pd.set_option('display.max_columns', None)  # 显示所有列

for cDate in dateArr:
    print(f"Fetching data for {cDate}...")
    conditions = {"c_date": cDate, "num": N}
    data = dataIns.getCommonData('stock_extra', ['code', 'extra_val', 'num', 'c_date'], conditions, '', '')
    df = pd.DataFrame(data)
    # print(df)

    # 计算extra的值
    ins = ExtrsUtil()
    df = ins.extrsRank(df)

    # print(df)
    values = df[['code', 'c_date', 'extra_val', 'num', 'rank_val']].values.tolist()

    # print(values)

    #写入数据库
    dataIns.saveBatchCommonData('stock_extra_rank_copy', fields, values)